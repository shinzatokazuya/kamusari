{% extends "base.html" %}

{% block title %}IC - Kamusari{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero">
    <div class="container">
        <div class="hero-content">
            <h1>Explore a Hist√≥ria do Brasileir√£o</h1>
            <p class="hero-subtitle">Base de dados completa com {{ stats_gerais.total_partidas }} partidas, {{ stats_gerais.total_clubes }} clubes e {{ stats_gerais.total_jogadores }} jogadores desde 1971</p>

            <div class="hero-stats">
                <div class="stat-card">
                    <span class="stat-number">{{ stats_gerais.total_edicoes }}</span>
                    <span class="stat-label">Temporadas</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">{{ stats_gerais.total_partidas }}</span>
                    <span class="stat-label">Partidas</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">{{ stats_gerais.total_clubes }}</span>
                    <span class="stat-label">Clubes</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">{{ stats_gerais.total_jogadores }}</span>
                    <span class="stat-label">Jogadores</span>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Conte√∫do Principal -->
<div class="container main-grid">
    <!-- Coluna Principal -->
    <div class="main-column">
        <!-- Classifica√ß√£o Atual -->
        <section class="section-card">
            <div class="section-header">
                <h2>üèÜ Brasileir√£o {{ g.ANO_ATUAL }}</h2>
                <a href="{{ url_for('temporada', ano=g.ANO_ATUAL) }}" class="btn-secondary">Ver Completo</a>
            </div>

            {% if classificacao_atual %}
            <div class="table-responsive">
                <table class="classificacao-table">
                    <thead>
                        <tr>
                            <th>Pos</th>
                            <th>Clube</th>
                            <th>PTS</th>
                            <th>J</th>
                            <th>V</th>
                            <th>E</th>
                            <th>D</th>
                            <th>GP</th>
                            <th>GC</th>
                            <th>SG</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for time in classificacao_atual %}
                        <tr class="time-row {% if loop.index <= 4 %}zona-libertadores{% elif loop.index <= 6 %}zona-libertadores-quali{% elif loop.index <= 12 %}zona-sulamericana{% elif loop.index >= classificacao_atual|length - 3 %}zona-rebaixamento{% endif %}">
                            <td class="posicao">{{ time.posicao }}</td>
                            <td class="clube">
                                <a href="{{ url_for('clube', nome=time.clube) }}">{{ time.clube }}</a>
                            </td>
                            <td class="pontos"><strong>{{ time.pts }}</strong></td>
                            <td>{{ time.jogos }}</td>
                            <td>{{ time.v }}</td>
                            <td>{{ time.e }}</td>
                            <td>{{ time.d }}</td>
                            <td>{{ time.gp }}</td>
                            <td>{{ time.gc }}</td>
                            <td class="{% if time.sg > 0 %}positivo{% elif time.sg < 0 %}negativo{% endif %}">
                                {{ time.sg }}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <!-- Legenda das Zonas -->
            <div class="legenda-zonas">
                <span class="zona-item"><span class="cor-libertadores"></span> Libertadores</span>
                <span class="zona-item"><span class="cor-libertadores-quali"></span> Pr√©-Libertadores</span>
                <span class="zona-item"><span class="cor-sulamericana"></span> Sul-Americana</span>
                <span class="zona-item"><span class="cor-rebaixamento"></span> Rebaixamento</span>
            </div>
            {% else %}
            <p class="no-data">Dados da temporada {{ g.ANO_ATUAL }} ainda n√£o dispon√≠veis.</p>
            {% endif %}
        </section>

        <!-- √öltimos Jogos -->
        <section class="section-card">
            <div class="section-header">
                <h2>‚öΩ √öltimos Jogos</h2>
            </div>

            {% if ultimos_jogos %}
            <div class="jogos-lista">
                {% for jogo in ultimos_jogos %}
                <div class="jogo-card">
                    <div class="jogo-data">
                        <span class="data">{{ jogo.data }}</span>
                        <span class="rodada">{{ jogo.fase }}</span>
                    </div>
                    <div class="jogo-placar">
                        <div class="time time-mandante">
                            <a href="/clube/{{ jogo.mandante }}"><span class="nome-time">{{ jogo.mandante }}</span></a>
                        </div>
                        <a href="{{ url_for('jogo', jogo_id=jogo.ID) }}">
                            <div class="placar">
                                <span class="gols">{{ jogo.mandante_placar }}</span>
                                <span class="separador">√ó</span>
                                <span class="gols">{{ jogo.visitante_placar }}</span>
                            </div>
                        </a>
                        <div class="time time-visitante">
                            <a href="/clube/{{ jogo.visitante }}"><span class="nome-time">{{ jogo.visitante }}</span></a>
                        </div>
                    </div>
                    <div class="jogo-local">
                        {% if jogo.estadio %}
                        <span>üèüÔ∏è {{ jogo.estadio }}</span>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="no-data">Nenhum jogo registrado ainda nesta temporada.</p>
            {% endif %}
        </section>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar">
        <!-- Top 5 Hist√≥rico -->
        <section class="section-card">
            <h3>üèÖ Maiores Pontuadores Hist√≥ricos</h3>
            <p class="section-description">Os clubes com mais pontos acumulados desde 1971</p>

            {% if top_historico %}
            <div class="ranking-historico">
                {% for clube in top_historico %}
                <div class="ranking-item">
                    <span class="ranking-pos">{{ loop.index }}¬∫</span>
                    <div class="ranking-info">
                        <a href="{{ url_for('clube', nome=clube.clube) }}" class="ranking-nome">
                            {{ clube.clube }}
                        </a>
                        <div class="ranking-stats">
                            <span>{{ clube.pontos_total }} pts</span>
                            <span class="dot">‚Ä¢</span>
                            <span>{{ clube.jogos_total }} jogos</span>
                            <span class="dot">‚Ä¢</span>
                            <span>{{ clube.vitorias_total }} vit√≥rias</span>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <a href="{{ url_for('explorar') }}" class="btn-link">Ver classifica√ß√£o completa ‚Üí</a>
            {% endif %}
        </section>

        <!-- Atalhos de Navega√ß√£o -->
        <section class="section-card">
            <h3>üîç Explorar Dados</h3>
            <div class="quick-links">
                <a href="{{ url_for('explorar') }}" class="quick-link-item">
                    <span class="icon">üìä</span>
                    <div>
                        <strong>Por Temporada</strong>
                        <p>Veja classifica√ß√µes e estat√≠sticas de cada ano</p>
                    </div>
                </a>
                <a href="{{ url_for('explorar') }}#clubes" class="quick-link-item">
                    <span class="icon">‚öΩ</span>
                    <div>
                        <strong>Por Clube</strong>
                        <p>Hist√≥rico completo de todos os times</p>
                    </div>
                </a>
                <a href="{{ url_for('buscar') }}" class="quick-link-item">
                    <span class="icon">üîé</span>
                    <div>
                        <strong>Busca Avan√ßada</strong>
                        <p>Encontre jogadores, √°rbitros e mais</p>
                    </div>
                </a>
            </div>
        </section>

        <!-- Dica de Uso -->
        <section class="section-card dica-card">
            <h3>üí° Dica</h3>
            <p>Use a busca no topo da p√°gina para encontrar rapidamente qualquer clube, jogador, treinador ou √°rbitro na base de dados!</p>
        </section>
    </aside>
</div>

{% endblock %}

{% block extra_js %}
<script>
    // Adicionar interatividade aos cards da tabela
    document.querySelectorAll('.time-row').forEach(row => {
        row.addEventListener('click', function() {
            const link = this.querySelector('a');
            if (link) {
                window.location.href = link.href;
            }
        });
    });
</script>
{% endblock %}
